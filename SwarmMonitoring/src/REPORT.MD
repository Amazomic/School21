1) Использовать docker swarm из первого проекта. 

-   ![](images/1.png "vagrant")

2) Написать при помощи библиотеки Micrometer сборщики следующих метрик приложения: 
   - количество отправленных сообщений в rabbitmq;
   - количество обработанных сообщений в rabbitmq;
   - количество бронирований;
   - количество полученных запросов на gateway;
   - количество полученных запросов на авторизацию пользователей.
-   ![](images/2.png "metrics")
-   ![](images/2.1.png "metrics")

*  аналагично и для других сервисов

-   ![](images/2.2.png "metrics")


3) Добавить логи приложения с помощью Loki.

-   ![](images/3.1.png "metrics")
-   ![](images/3.png "metrics")

4) Создать новый стек для docker swarm из сервисов с Prometheus Server, Loki, node_exporter, blackbox_exporter, cAdvisor. Проверить получение метрик на порту 9090 через браузер.

-   ![](images/4.png "metrics")
-   ![](images/5.png "metrics")


## Part 2. Визуализация

В этой главе тебе предстоит настроить Grafana для визуализации метри и логов.

**== Задание ==**

1) Развернуть grafana как новый сервис в стеке мониторинга.

-   ![](images/6.png "metrics")

2) Добавить в grafana дашборд со следуюшими метриками:
   - количество нод;
   - количество контейнеров;
   - количество стеков;
   - количество CPU;
   - доступность google.com;
   - доступная и занятая память;

-   ![](images/7.png "metrics")

   - использование CPU по сервисам;
   - использование CPU по ядрам и узлам;
   - затраченная RAM;

-   ![](images/8.png "metrics")

   - количество отправленных сообщений в rabbitmq;
   - количество обработанных сообщений в rabbitmq;
   - количество бронирований;
   - количество полученных запросов на gateway;
   - количество полученных запросов на авторизацию пользователей;

-   ![](images/9.png "metrics")

   - логи приложения.

-   ![](images/10.png "metrics")
-   ![](images/11.png "metrics")

## Part 3. Отслеживание критических событий

В этой главе тебе предстоит настроить Alert Manager для оповещения о критических событиях.

**== Задание ==**

1) Развернуть alert manager как новый сервис в стеке монтиторинга.
-   ![](images/12.png "metrics")

2) Добавить следующие критические события:
   - доступная память меньше 100 мб;
   - затраченная RAM больше 1гб;
   - использование CPU по сервису превышает 10%.

-   ![](images/13.png "metrics")   

3) Настроить получение оповещений через личные email и телеграм.

-   ![](images/16.png "metrics")  
-   ![](images/14.jpg "metrics")   
-   ![](images/15.jpg "metrics")   


*  все конфигурационные файлы лежат в папкe swarm


